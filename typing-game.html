<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Speed Test</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat {
            text-align: center;
        }
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #0066cc;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        .text-display {
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 20px;
            line-height: 1.6;
            margin-bottom: 20px;
            min-height: 120px;
        }
        .char-correct {
            color: #28a745;
        }
        .char-incorrect {
            color: #dc3545;
            background: #ffebee;
        }
        .char-current {
            border-bottom: 2px solid #0066cc;
            animation: blink 1s infinite;
        }
        .char-pending {
            color: #666;
        }
        @keyframes blink {
            50% { border-color: transparent; }
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 8px;
            resize: none;
            font-family: inherit;
        }
        textarea:focus {
            outline: none;
            border-color: #0066cc;
        }
        .start-btn {
            display: block;
            margin: 20px auto;
            padding: 15px 40px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
        }
        .start-btn:hover {
            background: #0052a3;
        }
        .silly-character {
            position: fixed;
            font-size: 80px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 1000;
        }
        .silly-character.visible {
            opacity: 1;
        }
        @keyframes dance {
            0%, 100% { transform: translateY(0) rotate(-10deg) scale(1); }
            25% { transform: translateY(-20px) rotate(10deg) scale(1.1); }
            50% { transform: translateY(0) rotate(-10deg) scale(1); }
            75% { transform: translateY(-15px) rotate(15deg) scale(1.2); }
        }
        @keyframes bounce-around {
            0% { top: 20%; left: 10%; }
            25% { top: 60%; left: 80%; }
            50% { top: 30%; left: 50%; }
            75% { top: 70%; left: 20%; }
            100% { top: 20%; left: 10%; }
        }
        .dancing {
            animation: dance 0.4s infinite, bounce-around 3s infinite;
        }
        .message-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
            z-index: 999;
        }
        .message-overlay.visible {
            opacity: 1;
            pointer-events: all;
        }
        .message-content {
            background: white;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            max-width: 500px;
        }
        .message-content h2 {
            color: #333;
            font-size: 28px;
        }
        .message-content p {
            font-size: 48px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Typing Speed Test</h1>

    <div class="stats-bar">
        <div class="stat">
            <div class="stat-value" id="wpm">0</div>
            <div class="stat-label">WPM</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="accuracy">100%</div>
            <div class="stat-label">Accuracy</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="chars-typed">0</div>
            <div class="stat-label">Characters</div>
        </div>
    </div>

    <div class="text-display" id="text-display">
        Click "Start Test" to begin!
    </div>

    <textarea id="input" placeholder="Start typing here..." disabled></textarea>

    <button class="start-btn" id="start-btn">Start Test</button>

    <div class="silly-character" id="silly-char">ü§™</div>

    <div class="message-overlay" id="overlay">
        <div class="message-content">
            <h2>Congratulations!</h2>
            <p>üéâ</p>
            <div id="final-message"></div>
        </div>
    </div>

    <script>
        const normalTexts = [
            "The quick brown fox jumps over the lazy dog. Pack my box with five dozen liquor jugs. How vexingly quick daft zebras jump! The five boxing wizards jump quickly. Sphinx of black quartz, judge my vow.",
            "Programming is the art of telling a computer what to do. Every programmer starts with a simple hello world program and gradually builds more complex applications over time.",
            "The sun sets slowly over the mountain peaks, casting long shadows across the valley below. Birds sing their evening songs as the day comes to a peaceful end.",
            "Technology continues to advance at an incredible pace, transforming how we live, work, and communicate with one another. The digital age has brought unprecedented changes to society."
        ];

        const sillyPhrase = "William is a silly boy. ";
        const sillyFaces = ['ü§™', 'üòú', 'üôÉ', 'üòù', 'ü§°', 'üëª', 'üéÉ', 'üòµ‚Äçüí´', 'ü•¥', 'ü§ì'];

        let currentText = "";
        let displayedText = "";
        let typedChars = 0;
        let correctChars = 0;
        let startTime = null;
        let sillyMode = false;
        let speedMultiplier = 1;
        let speechStarted = false;
        let speechInterval = null;
        let gameActive = false;

        const textDisplay = document.getElementById('text-display');
        const input = document.getElementById('input');
        const startBtn = document.getElementById('start-btn');
        const wpmEl = document.getElementById('wpm');
        const accuracyEl = document.getElementById('accuracy');
        const charsEl = document.getElementById('chars-typed');
        const sillyChar = document.getElementById('silly-char');
        const overlay = document.getElementById('overlay');

        function startGame() {
            currentText = normalTexts[Math.floor(Math.random() * normalTexts.length)];
            displayedText = currentText;
            typedChars = 0;
            correctChars = 0;
            startTime = null;
            sillyMode = false;
            speedMultiplier = 1;
            speechStarted = false;
            gameActive = true;

            if (speechInterval) {
                clearInterval(speechInterval);
                speechInterval = null;
            }
            window.speechSynthesis.cancel();

            input.disabled = false;
            input.value = "";
            input.focus();
            startBtn.textContent = "Restart";
            sillyChar.classList.remove('visible', 'dancing');
            overlay.classList.remove('visible');

            updateDisplay();
        }

        function updateDisplay() {
            let html = "";
            const typed = input.value;

            for (let i = 0; i < displayedText.length; i++) {
                if (i < typed.length) {
                    if (typed[i] === displayedText[i]) {
                        html += `<span class="char-correct">${displayedText[i]}</span>`;
                    } else {
                        html += `<span class="char-incorrect">${displayedText[i]}</span>`;
                    }
                } else if (i === typed.length) {
                    html += `<span class="char-current">${displayedText[i]}</span>`;
                } else {
                    html += `<span class="char-pending">${displayedText[i]}</span>`;
                }
            }

            textDisplay.innerHTML = html;
        }

        function calculateWPM() {
            if (!startTime) return 0;
            const elapsed = (Date.now() - startTime) / 1000 / 60;
            if (elapsed === 0) return 0;
            const words = correctChars / 5;
            return Math.round((words / elapsed) * speedMultiplier);
        }

        function updateStats() {
            const wpm = calculateWPM();
            wpmEl.textContent = wpm;

            const accuracy = typedChars > 0
                ? Math.round((correctChars / typedChars) * 100)
                : 100;
            accuracyEl.textContent = accuracy + "%";

            charsEl.textContent = typedChars;
        }

        function speakSilly() {
            if (!window.speechSynthesis) return;

            const utterance = new SpeechSynthesisUtterance("William is a silly boy");
            utterance.rate = 1 + (speedMultiplier - 1) * 0.3;
            utterance.pitch = 0.8 + Math.random() * 0.8;
            window.speechSynthesis.speak(utterance);
        }

        function enterSillyMode() {
            if (sillyMode) return;
            sillyMode = true;

            sillyChar.classList.add('visible', 'dancing');

            setInterval(() => {
                sillyChar.textContent = sillyFaces[Math.floor(Math.random() * sillyFaces.length)];
            }, 300);
        }

        function handleInput() {
            if (!gameActive) return;

            if (!startTime) {
                startTime = Date.now();
            }

            typedChars = input.value.length;

            // Count correct characters
            correctChars = 0;
            for (let i = 0; i < input.value.length && i < displayedText.length; i++) {
                if (input.value[i] === displayedText[i]) {
                    correctChars++;
                }
            }

            // After 200 characters, enter silly mode
            if (typedChars >= 200 && !sillyMode) {
                enterSillyMode();
            }

            // In silly mode, the displayed text keeps showing the silly phrase
            if (sillyMode) {
                // Increase speed multiplier
                speedMultiplier = 1 + ((typedChars - 200) / 20);
                if (speedMultiplier > 50) speedMultiplier = 50;

                // Keep extending the text with silly phrases
                while (displayedText.length < typedChars + 300) {
                    displayedText += sillyPhrase;
                }

                // Start speech after a bit more typing
                if (typedChars >= 250 && !speechStarted) {
                    speechStarted = true;
                    speakSilly();
                    speechInterval = setInterval(() => {
                        speakSilly();
                    }, 2500 - Math.min(speedMultiplier * 30, 2000));
                }

                // Update speech interval speed
                if (speechStarted && typedChars % 30 === 0) {
                    clearInterval(speechInterval);
                    const interval = Math.max(500, 2500 - speedMultiplier * 50);
                    speechInterval = setInterval(speakSilly, interval);
                }
            }

            updateDisplay();
            updateStats();

            // End game check (only in normal mode)
            if (!sillyMode && input.value.length >= currentText.length) {
                endGame();
            }

            // In silly mode, after 500 chars just keep going forever
            if (sillyMode && typedChars >= 500) {
                // Make the WPM go absolutely crazy
                speedMultiplier = 100 + Math.random() * 200;
                updateStats();
            }
        }

        function endGame() {
            gameActive = false;
            input.disabled = true;

            const finalWPM = calculateWPM();
            document.getElementById('final-message').innerHTML =
                `<p>Your speed: <strong>${finalWPM} WPM</strong></p>`;
            overlay.classList.add('visible');
        }

        input.addEventListener('input', handleInput);
        startBtn.addEventListener('click', startGame);

        // Prevent paste
        input.addEventListener('paste', (e) => e.preventDefault());
    </script>
</body>
</html>
